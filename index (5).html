<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HACCP-CMR Documentation Builder</title>
    
    <!-- Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Main Application Container -->
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>HACCP-CMR Documentation Builder</h1>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" onclick="exportToWord()">
                    <span>üìÑ</span> Export√°l√°s Word-be
                </button>
                <button class="btn btn-secondary" onclick="openBackupModal()">
                    <span>üíæ</span> Ment√©s/Vissza√°ll√≠t√°s
                </button>
                <span class="version-badge">v2.0.0</span>
            </div>
        </header>

        <!-- Main Content Area -->
        <div class="main-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <!-- Tab Navigation -->
                <div class="tab-navigation">
                    <button class="tab-btn active" onclick="switchTab('documents')" data-tab="documents">
                        üìÑ Dokumentumok
                    </button>
                    <button class="tab-btn" onclick="switchTab('blocks')" data-tab="blocks">
                        üß± Blokkok
                    </button>
                    <button class="tab-btn" onclick="switchTab('clients')" data-tab="clients">
                        üë• √úgyfelek
                    </button>
                    <button class="tab-btn" onclick="switchTab('templates')" data-tab="templates">
                        üìã Sablonok
                    </button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Documents Tab -->
                    <div id="documents-tab" class="tab-pane active">
                        <div class="tab-header">
                            <h3>Dokumentumok</h3>
                            <button class="btn btn-small btn-primary" onclick="createNewDocument()">
                                + √öj dokumentum
                            </button>
                        </div>
                        <div id="documents-list" class="list-container">
                            <!-- Documents will be rendered here -->
                        </div>
                    </div>

                    <!-- Blocks Tab -->
                    <div id="blocks-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3>Blokk Csoportok</h3>
                            <button class="btn btn-small btn-primary" onclick="createNewGroup()">
                                + √öj csoport
                            </button>
                        </div>
                        <div id="blocks-list" class="list-container">
                            <!-- Block groups will be rendered here -->
                        </div>
                    </div>

                    <!-- Clients Tab -->
                    <div id="clients-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3>√úgyfelek</h3>
                            <button class="btn btn-small btn-primary" onclick="createNewClient()">
                                + √öj √ºgyf√©l
                            </button>
                        </div>
                        <div id="clients-list" class="list-container">
                            <!-- Clients will be rendered here -->
                        </div>
                    </div>

                    <!-- Templates Tab -->
                    <div id="templates-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3>Sablonok</h3>
                            <button class="btn btn-small btn-primary" onclick="saveCurrentAsTemplate()">
                                + Ment√©s sablonk√©nt
                            </button>
                        </div>
                        <div id="templates-list" class="list-container">
                            <!-- Templates will be rendered here -->
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Canvas -->
            <main class="canvas">
                <div id="document-editor">
                    <div class="canvas-header">
                        <input type="text" id="document-title" class="document-title-input" placeholder="Dokumentum c√≠me..." onchange="updateDocumentTitle()">
                        <div class="canvas-actions">
                            <select id="client-selector" onchange="assignClientToDocument()">
                                <option value="">V√°lassz √ºgyfelet...</option>
                            </select>
                        </div>
                    </div>
                    <div id="blocks-canvas" class="blocks-canvas">
                        <!-- Document blocks will be rendered here -->
                        <div class="empty-state">
                            <p>üß± H√∫zd ide a blokkokat a bal oldali men√ºb≈ël</p>
                            <p>vagy kattints az "√öj blokk hozz√°ad√°sa" gombra</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <!-- Block Editor Modal -->
    <div id="block-editor-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>Blokk szerkeszt√©se</h2>
                <button class="close-btn" onclick="closeBlockEditor()">&times;</button>
            </div>
            <div class="modal-body">
                <label>Blokk neve:</label>
                <input type="text" id="block-name-input" class="form-input">
                
                <label>Tartalom:</label>
                <div id="block-content-editor"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBlockEditor()">M√©gse</button>
                <button class="btn btn-primary" onclick="saveBlock()">Ment√©s</button>
            </div>
        </div>
    </div>

    <!-- Client Editor Modal -->
    <div id="client-editor-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>√úgyf√©l adatai</h2>
                <button class="close-btn" onclick="closeClientEditor()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <div>
                        <label>C√©gn√©v *</label>
                        <input type="text" id="client-company-name" class="form-input" required>
                    </div>
                    <div>
                        <label>Kapcsolattart√≥ neve</label>
                        <input type="text" id="client-contact-person" class="form-input">
                    </div>
                    <div>
                        <label>Email</label>
                        <input type="email" id="client-email" class="form-input">
                    </div>
                    <div>
                        <label>Telefonsz√°m</label>
                        <input type="tel" id="client-phone" class="form-input">
                    </div>
                    <div>
                        <label>C√≠m</label>
                        <input type="text" id="client-address" class="form-input">
                    </div>
                    <div>
                        <label>V√°ros</label>
                        <input type="text" id="client-city" class="form-input">
                    </div>
                    <div>
                        <label>Orsz√°g</label>
                        <input type="text" id="client-country" class="form-input" value="Magyarorsz√°g">
                    </div>
                    <div>
                        <label>Ir√°ny√≠t√≥sz√°m</label>
                        <input type="text" id="client-postal-code" class="form-input">
                    </div>
                    <div>
                        <label>Ad√≥sz√°m</label>
                        <input type="text" id="client-tax-id" class="form-input">
                    </div>
                    <div>
                        <label>Ipar√°g</label>
                        <input type="text" id="client-industry" class="form-input">
                    </div>
                    <div>
                        <label>Weboldal</label>
                        <input type="url" id="client-website" class="form-input">
                    </div>
                </div>
                <div style="margin-top: 15px;">
                    <label>Megjegyz√©sek</label>
                    <textarea id="client-notes" class="form-textarea" rows="4"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeClientEditor()">M√©gse</button>
                <button class="btn btn-primary" onclick="saveClient()">Ment√©s</button>
            </div>
        </div>
    </div>

    <!-- Backup/Restore Modal -->
    <div id="backup-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>Ment√©s √©s Vissza√°ll√≠t√°s</h2>
                <button class="close-btn" onclick="closeBackupModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="backup-section">
                    <h3>üíæ Teljes ment√©s l√©trehoz√°sa</h3>
                    <p>Az √∂sszes dokumentum, √ºgyf√©l, sablon √©s blokk ment√©se JSON f√°jlba.</p>
                    <button class="btn btn-primary" onclick="createBackup()">Ment√©s let√∂lt√©se</button>
                </div>
                <hr>
                <div class="backup-section">
                    <h3>üìÇ Vissza√°ll√≠t√°s f√°jlb√≥l</h3>
                    <p>Kor√°bbi ment√©s vissza√°ll√≠t√°sa. <strong>FIGYELEM:</strong> Ez fel√ºl√≠rja a jelenlegi adatokat!</p>
                    <input type="file" id="backup-file-input" accept=".json">
                    <button class="btn btn-secondary" onclick="restoreBackup()">Vissza√°ll√≠t√°s</button>
                </div>
                <hr>
                <div class="backup-section">
                    <h3>üóëÔ∏è Minden adat t√∂rl√©se</h3>
                    <p>Az √∂sszes adat v√©gleges t√∂rl√©se. Ez a m≈±velet <strong>nem visszavonhat√≥!</strong></p>
                    <button class="btn btn-danger" onclick="clearAllData()">Minden t√∂rl√©se</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBackupModal()">Bez√°r√°s</button>
            </div>
        </div>
    </div>

    <!-- Group Editor Modal -->
    <div id="group-editor-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>Csoport szerkeszt√©se</h2>
                <button class="close-btn" onclick="closeGroupEditor()">&times;</button>
            </div>
            <div class="modal-body">
                <label>Csoport neve:</label>
                <input type="text" id="group-name-input" class="form-input">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeGroupEditor()">M√©gse</button>
                <button class="btn btn-primary" onclick="saveGroup()">Ment√©s</button>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    
    <!-- Application JavaScript -->
    <script src="app.js"></script>
</body>
</html>
